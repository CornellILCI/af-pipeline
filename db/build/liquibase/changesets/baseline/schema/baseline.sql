--liquibase formatted sql

--changeset postgres:Create baseline database context:schema splitStatements:false rollbackSplitStatements:false
--comment: Create baseline database


/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 15.1 		*/
/*  Created On : 20-May-2020 10:52:43 PM 				*/
/*  DBMS       : PostgreSQL 						*/
/* ---------------------------------------------------- */



/* Create schema af */

CREATE SCHEMA af;


/* Create Tables */

CREATE TABLE af.analysis
(
	name varchar(50) NULL,
	description varchar(50) NULL,
	prediction_id integer NULL,
	status varchar(50) NULL,
	creation_timestamp timestamp without time zone NULL,
	modification_timestamp timestamp without time zone NULL,
	creator_id varchar(50) NULL,
	modifier_id varchar(50) NULL,
	is_void boolean NULL,
	tenant_id integer NULL,
	id integer NOT NULL   DEFAULT NEXTVAL(('af."analysis_id_seq"'::text)::regclass),
	model_id integer NULL,
	request_id integer NULL
)
;

CREATE TABLE af.job
(
	name varchar(50) NULL,
	time_start varchar(50) NULL,
	time_end varchar(50) NULL,
	output_path varchar(50) NULL,
	status varchar(50) NULL,
	status_message varchar(50) NULL,
	size varchar(50) NULL,
	creation_timestamp timestamp without time zone NULL,
	modification_timestamp timestamp without time zone NULL,
	creator_id varchar(50) NULL,
	modifier_id varchar(50) NULL,
	is_void boolean NULL,
	tenant_id integer NULL,
	id integer NOT NULL   DEFAULT NEXTVAL(('af."job_id_seq"'::text)::regclass),
	analysis_id integer NULL
)
;

CREATE TABLE af.property
(
	code varchar(50) NULL,
	name varchar(50) NULL,
	label varchar(50) NULL,
	description varchar(50) NULL,
	type varchar(50) NULL,
	data_type varchar(50) NULL,
	creation_timestamp timestamp without time zone NULL,
	modification_timestamp timestamp without time zone NULL,
	creator_id varchar(50) NULL,
	modifier_id varchar(50) NULL,
	is_void boolean NULL,
	tenant_id integer NULL,
	id integer NOT NULL   DEFAULT NEXTVAL(('af."property_id_seq"'::text)::regclass)
)
;

CREATE TABLE af.property_acl
(
	property_item_id integer NULL,
	breeding_program_id integer NULL,
	phase_id integer NULL,
	creation_timestamp timestamp without time zone NULL,
	modification_timestamp timestamp without time zone NULL,
	creator_id varchar(50) NULL,
	modifier_id varchar(50) NULL,
	is_void boolean NULL,
	tenant_id integer NULL,
	id integer NOT NULL   DEFAULT NEXTVAL(('af."property_acl_id_seq"'::text)::regclass),
	property_id integer NULL
)
;

CREATE TABLE af.property_config
(
	is_required boolean NULL   DEFAULT false,
	order_number integer NULL   DEFAULT 1,
	creation_timestamp timestamp without time zone NULL,
	modification_timestamp timestamp without time zone NULL,
	creator_id varchar(50) NULL,
	modifier_id varchar(50) NULL,
	is_void boolean NULL,
	tenant_id integer NULL,
	id integer NOT NULL   DEFAULT NEXTVAL(('af."property_config_id_seq"'::text)::regclass),
	property_id integer NULL,
	config_property_id integer NULL,
	property_ui_id integer NULL
)
;

CREATE TABLE af.property_rule
(
	type varchar(50) NULL,
	expression varchar(50) NULL,
	"group" integer NULL   DEFAULT 0,
	creation_timestamp timestamp without time zone NULL,
	modification_timestamp timestamp without time zone NULL,
	creator_id varchar(50) NULL,
	modifier_id varchar(50) NULL,
	is_void boolean NULL,
	tenant_id integer NULL,
	id integer NOT NULL   DEFAULT NEXTVAL(('af."property_rule_id_seq"'::text)::regclass),
	property_id integer NULL,
	property_config_id integer NULL
)
;

CREATE TABLE af.property_ui
(
	is_visible boolean NULL   DEFAULT true,
	minimum integer NULL,
	maximum integer NULL,
	unit varchar(50) NULL,
	"default" varchar(50) NULL,
	is_disabled boolean NULL   DEFAULT false,
	is_multiple boolean NULL   DEFAULT false,
	is_catalogue boolean NULL   DEFAULT false,
	creation_timestamp timestamp without time zone NULL,
	modification_timestamp timestamp without time zone NULL,
	creator_id varchar(50) NULL,
	modifier_id varchar(50) NULL,
	is_void boolean NULL,
	tenant_id integer NULL,
	id integer NOT NULL   DEFAULT NEXTVAL(('af."property_ui_id_seq"'::text)::regclass)
)
;

CREATE TABLE af.request
(
	uuid varchar(50) NULL,
	category integer NULL,
	type varchar(50) NULL,
	design varchar(50) NULL,
	requestor_id integer NULL,
	institute varchar(50) NULL,
	crop varchar(50) NULL,
	program varchar(50) NULL,
	status varchar(50) NULL,
	creation_timestamp timestamp without time zone NULL,
	modification_timestamp timestamp without time zone NULL,
	creator_id varchar(50) NULL,
	modifier_id varchar(50) NULL,
	is_void boolean NULL,
	tenant_id integer NULL,
	id integer NOT NULL   DEFAULT NEXTVAL(('af."request_id_seq"'::text)::regclass),
	method_id integer NULL
)
;

CREATE TABLE af.request_parameter
(
	value varchar(50) NULL,
	creation_timestamp timestamp without time zone NULL,
	modification_timestamp timestamp without time zone NULL,
	creator_id varchar(50) NULL,
	modifier_id varchar(50) NULL,
	is_void boolean NULL,
	tenant_id integer NULL,
	id integer NOT NULL   DEFAULT NEXTVAL(('af."request_parameter_id_seq"'::text)::regclass),
	property_id integer NULL,
	request_id integer NULL
)
;

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE af.analysis ADD CONSTRAINT "PK_analysis"
	PRIMARY KEY (id)
;

ALTER TABLE af.job ADD CONSTRAINT "PK_job"
	PRIMARY KEY (id)
;

ALTER TABLE af.property ADD CONSTRAINT "PK_property"
	PRIMARY KEY (id)
;

ALTER TABLE af.property_acl ADD CONSTRAINT "PK_property_acl"
	PRIMARY KEY (id)
;

ALTER TABLE af.property_config ADD CONSTRAINT "PK_property_config"
	PRIMARY KEY (id)
;

ALTER TABLE af.property_rule ADD CONSTRAINT "PK_property_rule"
	PRIMARY KEY (id)
;

ALTER TABLE af.property_ui ADD CONSTRAINT "PK_property_ui"
	PRIMARY KEY (id)
;

ALTER TABLE af.request ADD CONSTRAINT "PK_request"
	PRIMARY KEY (id)
;

ALTER TABLE af.request_parameter ADD CONSTRAINT "PK_request_parameter"
	PRIMARY KEY (id)
;

/* Create Foreign Key Constraints */

ALTER TABLE af.analysis ADD CONSTRAINT "FK_analysis_property"
	FOREIGN KEY (model_id) REFERENCES af.property (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.analysis ADD CONSTRAINT "FK_analysis_request"
	FOREIGN KEY (request_id) REFERENCES af.request (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.job ADD CONSTRAINT "FK_job_analysis"
	FOREIGN KEY (analysis_id) REFERENCES af.analysis (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.property_acl ADD CONSTRAINT "FK_property_acl_property"
	FOREIGN KEY (property_id) REFERENCES af.property (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.property_config ADD CONSTRAINT "FK_property_config_property"
	FOREIGN KEY (property_id) REFERENCES af.property (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.property_config ADD CONSTRAINT "FK_property_config_property_ui"
	FOREIGN KEY (property_ui_id) REFERENCES af.property_ui (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.property_rule ADD CONSTRAINT "FK_property_rule_property"
	FOREIGN KEY (property_id) REFERENCES af.property (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.property_rule ADD CONSTRAINT "FK_property_rule_property_config"
	FOREIGN KEY (property_config_id) REFERENCES af.property_config (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.request ADD CONSTRAINT "FK_request_property"
	FOREIGN KEY (method_id) REFERENCES af.property (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.request_parameter ADD CONSTRAINT "FK_request_parameter_property"
	FOREIGN KEY (property_id) REFERENCES af.property (id) ON DELETE No Action ON UPDATE No Action
;

ALTER TABLE af.request_parameter ADD CONSTRAINT "FK_request_parameter_request"
	FOREIGN KEY (request_id) REFERENCES af.request (id) ON DELETE No Action ON UPDATE No Action
;

/* Create Table Comments, Sequences for Autonumber Columns */

CREATE SEQUENCE af.analysis_id_seq INCREMENT 1 START 1
;

CREATE SEQUENCE af.job_id_seq INCREMENT 1 START 1
;

CREATE SEQUENCE af.property_id_seq INCREMENT 1 START 1
;

CREATE SEQUENCE af.property_acl_id_seq INCREMENT 1 START 1
;

CREATE SEQUENCE af.property_config_id_seq INCREMENT 1 START 1
;

CREATE SEQUENCE af.property_rule_id_seq INCREMENT 1 START 1
;

CREATE SEQUENCE af.property_ui_id_seq INCREMENT 1 START 1
;

CREATE SEQUENCE af.request_id_seq INCREMENT 1 START 1
;

CREATE SEQUENCE af.request_parameter_id_seq INCREMENT 1 START 1
;